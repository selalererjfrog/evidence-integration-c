# Security configuration to address Tomcat vulnerabilities
# CVE-2025-49125: Authentication bypass vulnerability
# CVE-2025-24813: Path equivalence vulnerability
# CVE-2024-50379: TOCTOU race condition vulnerability

# Disable default servlet write access (prevents CVE-2025-24813, CVE-2024-50379)
server.servlet.default-servlet.readonly=true

# Configure secure multipart handling (prevents CVE-2025-48988)
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.file-size-threshold=2KB

# Disable HTTP/2 if not needed (prevents CVE-2024-34750, CVE-2024-24549)
# Uncomment the following line if HTTP/2 is not required:
# server.http2.enabled=false

# Configure secure session management
server.servlet.session.timeout=30m
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true

# Disable directory listing
server.servlet.default-servlet.enabled=false

# Configure secure headers
server.servlet.session.tracking-modes=cookie

# Disable CGI servlet if not needed (prevents CVE-2025-46701)
# This is disabled by default in Spring Boot

# Configure logging to prevent logback vulnerabilities
logging.level.root=INFO

# Disable actuator endpoints that might be vulnerable
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
